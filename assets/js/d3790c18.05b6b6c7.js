"use strict";(self.webpackChunkPCB_Design=self.webpackChunkPCB_Design||[]).push([[8860],{1121:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"projects/project-stm32/rf_design","title":"4. RF Section Design","description":"4.1 Impedance Matching Network","source":"@site/docs/09_projects/05_project-stm32/04_rf_design.md","sourceDirName":"09_projects/05_project-stm32","slug":"/projects/project-stm32/rf_design","permalink":"/PCB-Design-with-KiCad/docs/projects/project-stm32/rf_design","draft":false,"unlisted":false,"editUrl":"https://github.com/CagriCatik/PCB-Design-with-KiCad/tree/edit/main/webpage/docs/09_projects/05_project-stm32/04_rf_design.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{},"sidebar":"projectsSidebar","previous":{"title":"3. STM32 WB55 Microcontroller Power Architecture","permalink":"/PCB-Design-with-KiCad/docs/projects/project-stm32/stm32"},"next":{"title":"5. Oscillators","permalink":"/PCB-Design-with-KiCad/docs/projects/project-stm32/oscillator"}}');var t=i(4848),r=i(8453);const a={},l="4. RF Section Design",c={},o=[{value:"4.1 Impedance Matching Network",id:"41-impedance-matching-network",level:2},{value:"4.2 Low-Pass Filter (LPF)",id:"42-low-pass-filter-lpf",level:2},{value:"4.3 Antenna Interface",id:"43-antenna-interface",level:2},{value:"4.3.1 UFL Connector Implementation",id:"431-ufl-connector-implementation",level:3},{value:"4.4 PCB Layout Guidelines",id:"44-pcb-layout-guidelines",level:2},{value:"4.5 Validation and Testing",id:"45-validation-and-testing",level:2},{value:"4.6 Critical Design Rules",id:"46-critical-design-rules",level:2},{value:"Conclusion",id:"conclusion",level:2}];function d(n){const e={h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.header,{children:(0,t.jsx)(e.h1,{id:"4-rf-section-design",children:"4. RF Section Design"})}),"\n",(0,t.jsx)(e.h2,{id:"41-impedance-matching-network",children:"4.1 Impedance Matching Network"}),"\n",(0,t.jsx)(e.p,{children:"The RF section of the STM32 WB55CEU microcontroller incorporates a meticulously designed impedance matching network to ensure optimal signal transmission between the RF output and the antenna interface. A \u03c0-type LC network is employed to achieve a 50 \u03a9 impedance match, which is critical for maximizing power transfer and minimizing signal reflections. The design parameters and rationale are detailed below:"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"Component Values:"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"C1:"})," 0.8 pF, packaged in an 0402 footprint, utilizing a C0G dielectric with a tolerance of \xb10.1 pF (Murata GJM1555C1H8R0BB01)."]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"L1:"})," 2.7 nH, also in an 0402 package, with a tolerance of \xb10.3 nH and a Self-Resonant Frequency (SRF) exceeding 6 GHz (TDK MLG1005S2N7BTD25)."]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"C2:"})," 0.3 pF, packaged in an 0402 footprint, C0G dielectric with a tighter tolerance of \xb10.05 pF (Johanson Technology 0403HPH-RW0R3C)."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"Design Rationale:"})}),"\n",(0,t.jsx)(e.p,{children:"The \u03c0-type LC network is engineered to achieve a conjugate match at the operating frequency of 2.45 GHz, compensating for the inherent output impedance of the STM32 WB55CEU microcontroller, which is 22 + j15 \u03a9. This matching is essential for minimizing the Voltage Standing Wave Ratio (VSWR) and ensuring efficient power transfer to the antenna."}),"\n",(0,t.jsx)(e.p,{children:"Simulations conducted using Ansys HFSS confirm the effectiveness of the impedance matching network, demonstrating a return loss (S11) of \u2264 \u201315 dB and an insertion loss (S21) of \u2265 \u20130.5 dB. These metrics indicate a highly efficient match, with minimal signal reflection and acceptable signal attenuation, thereby ensuring robust RF performance."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"42-low-pass-filter-lpf",children:"4.2 Low-Pass Filter (LPF)"}),"\n",(0,t.jsx)(e.p,{children:"To suppress harmonics and maintain signal integrity within the desired frequency band, a Low-Pass Filter (LPF) is integrated into the RF section. The selected component and its specifications are as follows:"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"Specifications:"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"Cutoff Frequency:"})," 2.5 GHz (3 dB point), effectively filtering out higher frequency harmonics."]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"Attenuation:"})," \u2265 30 dB at 4.8 GHz (second harmonic), ensuring compliance with regulatory standards and minimizing interference."]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"Insertion Loss:"})," \u2264 0.6 dB at 2.45 GHz, ensuring minimal signal degradation at the operating frequency."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"Custom Footprint Design:"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"Pad Dimensions:"})," 0.3 \xd7 0.25 mm, precisely matching TDK\u2019s recommended land pattern to ensure reliable soldering and electrical connectivity."]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"Via Fencing:"})," An array of vias with a diameter of 0.2 mm spaced at 0.5 mm intervals surrounds the filter. This configuration provides ground isolation, reducing potential electromagnetic interference (EMI) and enhancing the filter\u2019s effectiveness."]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"3D Model Integration:"})," STEP files sourced from TDK\u2019s datasheet are imported into the PCB design software to validate component placement and ensure mechanical compatibility during assembly."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"43-antenna-interface",children:"4.3 Antenna Interface"}),"\n",(0,t.jsx)(e.p,{children:"The antenna interface is a critical component for effective wireless communication. The design utilizes a Hirose U.FL connector, optimized for high-frequency performance and mechanical stability."}),"\n",(0,t.jsx)(e.h3,{id:"431-ufl-connector-implementation",children:"4.3.1 UFL Connector Implementation"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"Hirose U.FL Series (UFL-LP-066):"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"Impedance:"})," 50 \u03a9, ensuring compatibility with the impedance-matched RF trace and the antenna."]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"Bandwidth:"})," 6 GHz, providing ample margin beyond the operational frequency of 2.45 GHz to accommodate signal integrity and reduce insertion loss."]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"Footprint:"})," Designed with a 1.6 \xd7 1.2 mm pad area and a central signal pin with a diameter of 0.3 mm. This compact footprint facilitates efficient use of PCB real estate while maintaining robust electrical connections."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"Ground Shielding:"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"Copper Pour:"})," A comprehensive ground plane is implemented beneath the U.FL connector, excluding a 0.5 mm keepout area around the signal pad. This configuration prevents unwanted coupling and maintains signal purity by providing a low-impedance return path."]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"Via Array:"})," An array of eight vias with a diameter of 0.2 mm and spaced at 0.5 mm intervals surrounds the connector. This arrangement ensures a reliable RF return path and enhances shielding effectiveness, thereby minimizing EMI and maintaining signal integrity."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"44-pcb-layout-guidelines",children:"4.4 PCB Layout Guidelines"}),"\n",(0,t.jsx)(e.p,{children:"Adhering to stringent PCB layout guidelines is essential for maintaining high RF performance and compliance with electromagnetic compatibility (EMC) standards. The following guidelines outline the critical aspects of the PCB layout for the RF section:"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"Stackup:"})}),"\n",(0,t.jsx)(e.p,{children:"The PCB employs a 4-layer FR-4 stackup arranged as Top\u2013Ground (GND)\u2013Power (PWR)\u2013Bottom. The dielectric thickness between layers is maintained at 0.2 mm using a prepreg material with a relative permittivity (\u03b5\u1d63) of 4.3 and a loss tangent (tan \u03b4) of 0.02 at 1 GHz. This configuration minimizes signal attenuation and preserves signal integrity across high-frequency traces."}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"RF Trace Routing:"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"Width:"})," 0.3 mm, configured as a 50 \u03a9 coplanar waveguide with a 0.15 mm gap to the ground plane. This design ensures controlled impedance, which is critical for high-frequency signal transmission."]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"Length:"})," Traces are minimized to less than 15 mm to limit phase shift (\u2264 10\xb0 at 2.45 GHz) and reduce signal degradation."]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"Bends:"})," Implemented as 45\xb0 miters with a radius of at least three times the trace width (0.9 mm) to minimize reflections and maintain signal continuity."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"Component Placement:"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"\u03c0-Network and LPF Placement:"})," Positioned within 5 mm of the RF output pin (PA0, pin 21) to reduce trace length and associated signal losses."]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"Decoupling Capacitors:"})," 100 nF capacitors are placed within 2 mm of the LPF\u2019s VDD pin to ensure effective high-frequency noise suppression and maintain power integrity."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"45-validation-and-testing",children:"4.5 Validation and Testing"}),"\n",(0,t.jsx)(e.p,{children:"Validation of the RF section design is imperative to ensure adherence to performance specifications and regulatory compliance. The following testing methodologies are employed:"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"Vector Network Analyzer (VNA):"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"Measurements:"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"S11 (Return Loss):"})," Must be \u2264 \u201310 dB within the 2.4\u20132.48 GHz frequency band, indicating efficient impedance matching and minimal signal reflection."]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"S21 (Insertion Loss):"})," Must be \u2265 \u20131 dB, ensuring that signal transmission through the RF path remains efficient with minimal loss."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"Tuning:"})," The \u03c0-network is fine-tuned using a Smith chart to adjust the values of C1, L1, and C2, achieving the minimum S11 for optimal matching."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"Spectrum Analyzer:"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Harmonic Suppression:"})," Verification that harmonic frequencies, specifically the second harmonic at 4.8 GHz, are suppressed to \u2264 \u201341 dBm. This ensures compliance with FCC Part 15.247 regulations and minimizes interference with other wireless systems."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"46-critical-design-rules",children:"4.6 Critical Design Rules"}),"\n",(0,t.jsx)(e.p,{children:"Adherence to critical design rules is essential for ensuring the RF section's functionality, reliability, and compliance with industry standards. The following design rules are strictly enforced:"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"Clearance:"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"RF Trace to Digital Signals:"})," A minimum clearance of three times the trace width (0.9 mm) is maintained to prevent electromagnetic coupling between RF and digital signals, thereby reducing the risk of signal interference and maintaining signal integrity."]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"UFL Connector to Board Edge:"})," A clearance of at least 5 mm from the UFL connector to the board edge is enforced to ensure mechanical stability and prevent accidental damage or disconnections."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"Thermal Management:"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"Reflow Profile:"})," The soldering process adheres to a reflow profile with a peak temperature of 245\xb0C and maintains 60 seconds above 217\xb0C. This profile is optimized for SAC305 solder to ensure reliable solder joints without compromising component integrity."]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"Thermal Relief:"})," Ground pads for inductors are connected to the ground plane via 0.3 mm thermal spokes. This design mitigates soldering stress by providing controlled thermal pathways, preventing thermal gradients that could lead to mechanical stress or solder joint failures."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,t.jsx)(e.p,{children:"The RF section design of the STM32 WB55CEU microcontroller is meticulously crafted to adhere to IPC-2221B standards and STM32 AN5165 guidelines, ensuring robust Bluetooth Low Energy (BLE) performance with minimal electromagnetic interference (EMI) and electromagnetic compatibility (EMC) risks. By implementing precise impedance matching, effective harmonic suppression, and adhering to stringent PCB layout guidelines, the RF section achieves high signal integrity and regulatory compliance. The comprehensive validation and adherence to critical design rules further guarantee reliable and efficient wireless communication in advanced embedded applications."})]})}function h(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(d,{...n})}):d(n)}},8453:(n,e,i)=>{i.d(e,{R:()=>a,x:()=>l});var s=i(6540);const t={},r=s.createContext(t);function a(n){const e=s.useContext(r);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:a(n.components),s.createElement(r.Provider,{value:e},n.children)}}}]);